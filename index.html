<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Expert Touchpoints Demo — Embedded Help • Contextual Help • Search-in-Place • Sign-In</title>
  <style>
    /* ============= Design Tokens ============= */
    :root{
      --ink:#0e0e0e; --muted:#666; --bg:#fff; --line:#eaeaea; --card:#ffffff;
      --brand:#c62828; --brand-ink:#fff; --shadow: 0 10px 30px rgba(0,0,0,.08);
      --radius:16px; --radius-sm:12px; --radius-xl:22px;
    }

    /* ============= Base ============= */
    html,body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.55 system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial,sans-serif}
    *{box-sizing:border-box}
    a{color:var(--brand)}

    /* ============= Header / Nav ============= */
    header{position:sticky;top:0;z-index:100;background:rgba(255,255,255,.92);backdrop-filter:saturate(140%) blur(6px);border-bottom:1px solid var(--line)}
    .wrap{max-width:1100px;margin:0 auto;padding:16px 18px}
    h1{margin:0;font-size:22px}
    .sub{color:var(--muted);margin-top:4px}
    nav{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    nav a{display:inline-block;padding:8px 12px;border-radius:999px;border:1px solid var(--line);text-decoration:none;color:var(--ink)}
    nav a:hover{border-color:var(--brand);color:var(--brand)}

    /* ============= Layout ============= */
    main{max-width:1100px;margin:0 auto;padding:24px 18px;display:grid;gap:22px}
    @media (min-width: 1024px){
      main{grid-template-columns:1fr 1fr;align-items:start}
      .span-2{grid-column:1/-1}
    }

    /* ============= Cards / Buttons ============= */
    .card{border:1px solid var(--line);border-radius:var(--radius);background:var(--card);box-shadow:var(--shadow);padding:18px}
    .card h2{margin:0 0 8px;font-size:20px}
    .muted{color:var(--muted)}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .btn{background:var(--brand);color:var(--brand-ink);border:none;border-radius:12px;padding:10px 14px;cursor:pointer;text-decoration:none}
    .btn.secondary{background:#f7f7f7;color:var(--ink);border:1px solid var(--line)}
    .btn:focus-visible{outline:3px solid #ffd7d7;outline-offset:2px}
    details{border:1px dashed var(--line);padding:10px;border-radius:12px;background:#fff}
    summary{cursor:pointer;color:var(--brand)}
    code{background:#fafafa;border:1px solid var(--line);padding:2px 6px;border-radius:6px}
    pre{background:#fafafa;border:1px solid var(--line);padding:12px;border-radius:12px;overflow:auto;max-height:340px}

    /* ============= Touchpoint z-index fixes ============= */
    /* Ensure touchpoint overlays and search dropdowns are always on top */
    #search{position:relative;z-index:20}
    #contextual{position:relative;z-index:10}
    #embedded{position:relative;z-index:5}
    /* common classes used by touchpoints; boost stacking */
    .mt-search-results, .mt-search, .mt-search-widget, .mt-contextual-help, .mt-contextual-help-container, [class*="mt-ctx"], [class*="contextual-help"], [class*="search-in-place"]{
      z-index: 9999 !important;
    }

    /* Avoid clipping; let overlays flow outside cards */
    .card{overflow:visible}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Expert Touchpoints Demo</h1>
      <div class="sub">Embedded Contextual Help • Contextual Help • Search‑in‑Place • Sign‑In</div>
      <nav>
        <a href="#embedded">Embedded Help</a>
        <a href="#contextual">Contextual Help</a>
        <a href="#search">Search‑in‑Place</a>
        <a href="#signin">Sign‑In</a>
      </nav>
    </div>
  </header>

  <main>
    <!-- ===================== EMBEDDED CONTEXTUAL HELP ===================== -->
    <section id="embedded" class="card span-2">
      <h2>Embedded Contextual Help (Inline Panel)</h2>
      <p class="muted">Paste the <strong>Embedded Contextual Help</strong> Touchpoint snippet below. This renders your Expert article inline.</p>
      <!-- BEGIN: Embedded Contextual Help Touchpoint embed -->
      <!-- EMBEDDED_CONTEXTUAL_HELP_SNIPPET -->
      <!-- END: Embedded Contextual Help Touchpoint embed -->
      <details>
        <summary>Setup tips</summary>
        <ul>
          <li>Expert: <em>Admin → Touchpoints → Create → Embedded Contextual Help</em> (allowlist your Render domain).</li>
          <li>Copy the generated HTML/JS snippet and replace <code>EMBEDDED_CONTEXTUAL_HELP_SNIPPET</code> above.</li>
        </ul>
      </details>
    </section>

    <!-- ===================== CONTEXTUAL HELP ===================== -->
    <section id="contextual" class="card">
      <h2>Contextual Help (Overlay Launcher)</h2>
      <p class="muted">Paste the <strong>Contextual Help</strong> Touchpoint <em>loader script</em> once, then use the configured class on links (e.g., <code>mt-contextual-help</code>).</p>
      <!-- BEGIN: Contextual Help Touchpoint loader -->
      <!-- CONTEXTUAL_HELP_SCRIPT_SNIPPET -->
      <!-- END: Contextual Help Touchpoint loader -->

      <div class="row" style="margin-top:8px">
        <a class="btn mt-contextual-help" href="https://chris-gallegos-test.cxoneexpert.ai/Path/To/Helpful/Article" target="_blank" rel="noopener">Open Help Overlay</a>
        <a class="btn secondary" href="#" onclick="window.scrollTo({top:0,behavior:'smooth'});return false;">Back to top</a>
      </div>
      <details>
        <summary>Setup tips</summary>
        <ul>
          <li>Create Touchpoint: <em>Contextual Help Button</em>. Choose the CSS class (e.g., <code>.mt-contextual-help</code>).</li>
          <li>Paste the script snippet here; apply the class to any link or button that should open the overlay.</li>
        </ul>
      </details>
    </section>

    <!-- ===================== SEARCH‑IN‑PLACE ===================== -->
    <section id="search" class="card">
      <h2>Search‑in‑Place</h2>
      <p class="muted">This renders a drop‑in search experience on this page.</p>
      <!-- Begin Search in Place, Type = search -->
      <!-- Generated on [11/07/2025 23:59:17] by MindTouch -->
      <script async="async" src="https://chris-gallegos-test.cxoneexpert.ai/@embed/aaa8998c32b56b7e6b55b4463e078509a10cc68ace58e0b9ccb76da61f733223.js"></script>
      <script type="mindtouch/embed" id="mindtouch-embed-aaa8998c32b56b7e6b55b4463e078509a10cc68ace58e0b9ccb76da61f733223"></script>
      <!-- End Search in Place -->

      <details>
        <summary>Setup tips</summary>
        <ul>
          <li>Touchpoint: <em>Search‑in‑Place</em>. Style in Expert; allowlist: <code>touchpoints-and-apis.onrender.com</code>.</li>
          <li>Paste the generated snippet here. Hard refresh after updating (Cmd/Ctrl+Shift+R).</li>
        </ul>
      </details>
    </section>

    <!-- ===================== SIGN‑IN ===================== -->
    <section id="signin" class="card span-2">
      <h2>Sign‑In (Authentication Flow)</h2>
      <p class="muted">Demo how users authenticate with Expert before viewing permissioned content.</p>
      <div class="row">
        <a class="btn" href="https://chris-gallegos-test.cxoneexpert.ai/Special:Userlogin" target="_blank" rel="noopener">Sign in to Expert</a>
        <a class="btn" href="https://chris-gallegos-test.cxoneexpert.ai/Path/To/Permissioned/Article" target="_blank" rel="noopener">Open a permissioned article</a>
      </div>
      <p class="muted" style="margin-top:8px">Use a test account/SSO. After login, the permissioned article loads if your role allows it.</p>
    </section>

    <!-- ===================== OPTIONAL: BROWSER TOKEN DEMO ===================== -->
    <section class="card span-2">
      <h2>Optional: Simple API Fetch (Browser Token)</h2>
      <p class="muted">For a quick API demo without a backend proxy, you can use a <em>scoped Browser API Token</em> (visible in the browser — rotate after demos).</p>
      <div class="row">
        <input id="pagePath" type="text" size="40" placeholder="/Path/To/Article" />
        <button class="btn" id="btnFetch">Fetch Page JSON</button>
      </div>
      <pre id="out">{ click “Fetch Page JSON” }</pre>
      <p class="muted">Prefer a server-side proxy for non-trivial demos. Do <strong>not</strong> commit tokens to Git.</p>
    </section>

  </main>

  <script>
    // Only use this token demo for short-lived demos; tokens are visible in the browser.
    const SITE = 'https://chris-gallegos-test.cxoneexpert.ai';
    const BROWSER_TOKEN = 'YOUR_BROWSER_TOKEN';

    async function fetchPage(path) {
      const url = `${SITE}/@api/deki/pages/=${encodeURIComponent(path)}?format=json`;
      const res = await fetch(url, { headers: { 'X-Deki-Token': BROWSER_TOKEN }});
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      return res.json();
    }

    const btn = document.getElementById('btnFetch');
    if (btn) {
      btn.addEventListener('click', async () => {
        const out = document.getElementById('out');
        const path = document.getElementById('pagePath').value.trim() || '/';
        out.textContent = 'Loading...';
        try {
          const data = await fetchPage(path);
          out.textContent = JSON.stringify(data, null, 2);
        } catch (e) {
          out.textContent = `Error: ${e.message}`;
        }
      });
    }
  </script>
</body>
</html>
